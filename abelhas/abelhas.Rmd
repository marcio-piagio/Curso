---
title: "É possível fazer seleção e melhoramento genético em abelhas?"
date: "20 de setembro de 2022"
author: "Márcio Piagio"
# subtitle: "Universidade Estatual de Maringá <br>Departamento de Estatística"
output:
  rmdformats::readthedown:
    highlight: kate
---

```{r,echo=FALSE,message=FALSE}
source("01funcoes.R", encoding = 'UTF-8')
source("theme_black.R", encoding = 'UTF-8')
source("00data.R", encoding = 'UTF-8')
options(warn=-1)
options(htmltools.dir.version = FALSE)
```



```{css,echo=FALSE}
p {
    font-size: 20px;
    font-weight: bold;
    }

#centralizar{
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    }

#content{
    max-width:100%;
    color: grey;
    <!-- background-color: #9F2042; -->
    <!-- background-image: url(favo.jpg); -->
    <!-- background-repeat: no-repeat; -->
    <!-- background-attachment: fixed; -->
    <!-- background-position: center; -->
    }
    
#sidebar {
    background-color: white;
    background-image: url("1 (1).png");
    background-repeat: no-repeat;
    background-size: 300px 500px;
    background-position: center;
    border: 1px solid #9F2042;
    }

#sidebar a{color: #9F2042;
            transition: all .5s;
            border: 10px solid transparent;}

#sidebar a:hover{
    color: red !important;
    background-color: #9F2042;
    text-decoration: underline;
    }
    
#sidebar a:link {
  background-color: yellow;
}

#sidebar a:visited {
  background-color: cyan;
}

#sidebar a:hover {
  background-color: lightgreen;
  width: auto;
  border: 10px solid #136497;
  border-radius: 50%;
}

#sidebar a:active {
  background-color: hotpink;
} 
    

#sidebar h2 a {
    color:#9F2042;
    text-decoration: none;
    border: 1px solid #9F2042;
    }

#toc ul.nav li.active ul li a {
    background-color: transparent;
    color: red;
    border-right:solid 1px transparent !important;
    }

#toc ul.nav li.active a {
    color: #9F2042  !important;
    border-bottom:solid 1px white;
    border-top:solid 1px white;
    background-color: transparent;
    }

#toc ul.nav li.active > a {
    border-bottom:solid 1px #9F2042 !important;
    border-right:solid 1px transparent !important;
    }

#postamble {
    background:transparent;
    border-top:solid 1px #9F2042;
    color: #9F2042 ;
    }

#postamble .date {color: #9F2042;}

.title {
    text-align: center;
    color: #9F2042;
    border: 1px solid #9F2042;
    background-color: white;
    padding: 50px;
    }

.subtitle {
    text-align: center;
    color: #9F2042;
    background-color: transparent;
    border: 1px solid transparent;
    }
    
#content h2 {
    color: #9F2042;
    background-color: white;
    border-bottom:solid 1px #9F2042 !important;
    }

h1, h2, h3, h4, h5, h6, legend {
    text-align: center;
    color: #9F2042;
    background-color: white;
    padding: 10px;
    border: 1px solid #9F2042;
    }



#toc ul.nav li.active ul li.active a {
    background-color: #9F2042;
    color: white !important;
    font-weight: none;
    }

```


Disciplina: Laboratório de Estatística Aplicada.

Professor: <a href = "http://www.des.uem.br/docentes/dfrossoni">Dr. Diogo Francisco Rossoni</a>

--- 

<br><br>


# Objetivos.


<p id="centralizar">Propor um modelo de regressão para constatar a melhor produção de mel (N° de potes de mel ao mês) entre as 16 colônias de abelhas da espécie Scaptotrigona bipuctata e posteriormente selecionar características em relação as colônias considerando o aperfeiçoamento da produção de mel</p>

<br><br>

---

<br><br>

# Descrição dos dados

* 16 Colônias de abelhas da espécie Scaptotrigona bipuctata

* Os dados foram coletados todos os meses em todas as colônias no ano de 2016

## As Características analisadas

* Comp. Canudo (cm) = Comprimento do canudo entrada das colônias;

* Diâm. Canudo (cm) = Diâmetro do canudo entrada das colônias;

* N° potes Mel = Número de Potes de mel;

* N° discos =  Número dos discos de crias;

* Tam. Discos (cm) = Média do diâmetro dos discos de crias;

* Peso (Kg) = Peso da colônia, já descontado o peso das caixas;

* Est. Pop. = Estimativa do número de indivíduos nas colônias de abelhas.


## Banco de dados {.tabset}

### Tipo de variável

```{r,echo=FALSE,out.width="100%"}
library(ggplot2)
visdat::vis_guess(Dados_abelhas)+
    theme(legend.position = "bottom", legend.background = element_rect(colour = "lightgray", size = .6), axis.text.x = element_text(hjust = 0.03))
```


---

### Frequência de zeros

```{r,echo=FALSE,out.width="100%"}
visdat::vis_expect(Dados_abelhas, ~.x == 0)+
    theme(legend.position = "bottom", legend.background = element_rect(colour = "lightgray", size = .6))
```

<br><br>

---

<br><br>

# Análise descritiva


```{r,echo=FALSE,out.width="100%"}
library(leaflet)
r <- resumo(numerica)
DT::datatable(r,class = 'cell-border stripe',
              fillContainer = FALSE,
              options = list(pageLength = 7,
                             searching=FALSE,
                             initComplete = JS(
    "function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#9F2042', 'color': '#fff', 'font-size': '13px', 'text-align':'right'});",
    "}")))%>%
  DT::formatStyle('N° potes Mel',  color = DT::styleEqual(c(111.4562,23.2656,25.931),'red')) 
```


## Potes de mel {.tabset}

### Histograma da distribuição

```{r,echo=FALSE,message=FALSE,fig.align='center',out.width="100%"}
ggplot(Dados_abelhas, aes(`N° potes Mel`)) +
  geom_histogram( aes(y =..density..),
                  col = 'black',fill='darkslategrey',alpha=0.6,bins= ceiling(sqrt(length(Dados_abelhas$Meses)))) +
  geom_density() +
  ylab(' ') +
  xlab('Número de Potes de mel')+
  theme_black()

```

### Frequência 

```{r,echo=FALSE,message=FALSE, fig.align='center',out.width="100%"}
pct_format = scales::percent_format(accuracy = .1)
ccc  <- Dados_abelhas %>% dplyr::group_by(`N° potes Mel`) %>% dplyr::summarise(n=n())
ggplot(ccc,aes(`N° potes Mel`,n)) +
  geom_col(fill='darkslategrey') + theme_minimal() +
    ylab('Frequência absoluta') +
  xlab('Número de Potes de mel')+
  geom_label(aes(
    label = sprintf(
      '%d (%s)',
      n,
      pct_format(n / sum(n))
    )),  fill='white', vjust=1,hjust=ifelse(ccc$n <= 14,-100,-.1))+
  theme_black()

```

## Quantidade de potes de mel por colônia 

```{r,echo=FALSE,message=FALSE,fig.align='center',out.width="100%"}
library(highcharter)
hcboxplot(
  x = Dados_abelhas$`N° potes Mel`,
  var = Dados_abelhas$Colônias,
  name = "Length",
  color = 'darkslategrey',
  outliers = TRUE
) %>%
  hc_chart(type = "column") %>%
  hc_title(text = " ") %>%
  hc_yAxis(title = list(text = "N° potes de Mel")) %>%
  hc_add_series(
    data = Dados_abelhas,
    type = "scatter",
    hcaes(x = "Colônias", y = "Dados_abelhas$`N° potes Mel`", group = "Colônias")
  ) %>%
  hc_plotOptions(scatter = list(
    color = "red",
    marker = list(
      radius = 2,
      symbol = "circle",
      lineWidth = 1
    )
  ))  %>%
  hc_plotOptions(scatter = list(jitter = list(x = .2, y = 0)))
```

```{r,echo=FALSE,message=FALSE,out.width="100%"}
library(plotly)
bar3 %>% plot_ly(x = ~Meses, y = ~`N° potes Mel`, color = ~Colônias)
```